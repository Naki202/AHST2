--// ===========================================
--// TP MENU 2.0
--// ===========================================

-- Nếu GUI đang tồn tại -> xóa
if game.CoreGui:FindFirstChild("TPMenu2") then
    game.CoreGui.TPMenu2:Destroy()
end

-- PRELOAD ÂM THANH
local SoundId = "rbxassetid://8383718211"
game:GetService("ContentProvider"):PreloadAsync({SoundId})

-- PLAY SOUND ULTRA FAST
local function PlayTPSound()
    local sound = Instance.new("Sound")
    sound.SoundId = SoundId
    sound.Volume = 1
    sound.PlayOnRemove = true -- hack giúp phát NGAY LẬP TỨC 
    sound.Parent = game:GetService("SoundService")
    sound:Destroy() -- phá object để nó phát liền
end


-- TẠO GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "TPfeces"
ScreenGui.Parent = game.CoreGui
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 220, 0, 280)
MainFrame.Position = UDim2.new(0, 50, 0, 100)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 30)
TopBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -35, 1, 0)
Title.Position = UDim2.new(0, 5, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "TP Menu 2.0"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14
Title.Parent = TopBar

local Minimize = Instance.new("TextButton")
Minimize.Size = UDim2.new(0, 30, 1, 0)
Minimize.Position = UDim2.new(1, -35, 0, 0)
Minimize.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Minimize.Text = "-"
Minimize.TextColor3 = Color3.fromRGB(255, 255, 255)
Minimize.Font = Enum.Font.GothamBold
Minimize.TextSize = 18
Minimize.Parent = TopBar

local SaveBtn = Instance.new("TextButton")
SaveBtn.Size = UDim2.new(1, -20, 0, 35)
SaveBtn.Position = UDim2.new(0, 10, 0, 40)
SaveBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
SaveBtn.Text = "+ Save Location"
SaveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
SaveBtn.Font = Enum.Font.Gotham
SaveBtn.TextSize = 14
SaveBtn.Parent = MainFrame

local SlotHolder = Instance.new("Frame")
SlotHolder.Size = UDim2.new(1, -20, 0, 190)
SlotHolder.Position = UDim2.new(0, 10, 0, 85)
SlotHolder.BackgroundTransparency = 1
SlotHolder.Parent = MainFrame

local SavedSlots = {}
local MaxSlots = 5
local minimized = false

-- HÀM TẠO SLOT
local function CreateSlot(index)
    local slot = Instance.new("Frame")
    slot.Size = UDim2.new(1, 0, 0, 35)
    slot.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    slot.Parent = SlotHolder

    local tpBtn = Instance.new("TextButton")
    tpBtn.Size = UDim2.new(1, -40, 1, 0)
    tpBtn.Position = UDim2.new(0, 5, 0, 0)
    tpBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    tpBtn.Text = "TP Slot " .. index
    tpBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    tpBtn.Font = Enum.Font.Gotham
    tpBtn.TextSize = 14
    tpBtn.Parent = slot

    local delBtn = Instance.new("TextButton")
    delBtn.Size = UDim2.new(0, 30, 1, 0)
    delBtn.Position = UDim2.new(1, -35, 0, 0)
    delBtn.BackgroundColor3 = Color3.fromRGB(200, 30, 30)
    delBtn.Text = "X"
    delBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    delBtn.Font = Enum.Font.GothamBold
    delBtn.TextSize = 14
    delBtn.Parent = slot

    -- NÚT TELEPORT
    tpBtn.MouseButton1Click:Connect(function()
        local plr = game.Players.LocalPlayer
        if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and SavedSlots[index] then
            plr.Character.HumanoidRootPart.CFrame = SavedSlots[index]
            PlayTPSound() -- âm thanh TP
        end
    end)

    -- NÚT XÓA SLOT
    delBtn.MouseButton1Click:Connect(function()
        SavedSlots[index] = nil
        slot:Destroy()
    end)

    return slot
end

-- SAVE LOCATION
SaveBtn.MouseButton1Click:Connect(function()
    if #SavedSlots >= MaxSlots then
        SaveBtn.Text = "MAX (5/5)"
        task.wait(1)
        SaveBtn.Text = "+ Save Location"
        return
    end

    local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    table.insert(SavedSlots, hrp.CFrame)

    local newSlot = CreateSlot(#SavedSlots)
    newSlot.Position = UDim2.new(0, 0, 0, (#SavedSlots - 1) * 40)
end)

-- MINIMIZE
Minimize.MouseButton1Click:Connect(function()
    minimized = not minimized

    if minimized then
        MainFrame.Size = UDim2.new(0, 220, 0, 35)
        SaveBtn.Visible = false
        SlotHolder.Visible = false
        Minimize.Text = "+"
    else
        MainFrame.Size = UDim2.new(0, 220, 0, 280)
        SaveBtn.Visible = true
        SlotHolder.Visible = true
        Minimize.Text = "-"
    end
end)Minimize.Text = "-"
Minimize.TextColor3 = Color3.fromRGB(255, 255, 255)
Minimize.Font = Enum.Font.GothamBold
Minimize.TextSize = 18
Minimize.Parent = TopBar

-- SAVE BUTTON
local SaveBtn = Instance.new("TextButton")
SaveBtn.Size = UDim2.new(1, -20, 0, 35)
SaveBtn.Position = UDim2.new(0, 10, 0, 40)
SaveBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
SaveBtn.Text = "+ Save Location"
SaveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
SaveBtn.Font = Enum.Font.Gotham
SaveBtn.TextSize = 14
SaveBtn.Parent = MainFrame

-- SLOTS HOLDER
local SlotHolder = Instance.new("Frame")
SlotHolder.Size = UDim2.new(1, -20, 0, 190)
SlotHolder.Position = UDim2.new(0, 10, 0, 85)
SlotHolder.BackgroundTransparency = 1
SlotHolder.Parent = MainFrame

-- VARIABLES
local SavedSlots = {}
local MaxSlots = 5
local minimized = false

-- CREATE SLOT FUNCTION
local function CreateSlot(index)
    local slot = Instance.new("Frame")
    slot.Size = UDim2.new(1, 0, 0, 35)
    slot.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    slot.Parent = SlotHolder

    local tpBtn = Instance.new("TextButton")
    tpBtn.Size = UDim2.new(1, -40, 1, 0)
    tpBtn.Position = UDim2.new(0, 5, 0, 0)
    tpBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    tpBtn.Text = "TP Slot " .. index
    tpBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    tpBtn.Font = Enum.Font.Gotham
    tpBtn.TextSize = 14
    tpBtn.Parent = slot

    local delBtn = Instance.new("TextButton")
    delBtn.Size = UDim2.new(0, 30, 1, 0)
    delBtn.Position = UDim2.new(1, -35, 0, 0)
    delBtn.BackgroundColor3 = Color3.fromRGB(200, 30, 30)
    delBtn.Text = "X"
    delBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    delBtn.Font = Enum.Font.GothamBold
    delBtn.TextSize = 14
    delBtn.Parent = slot

    -- TELEPORT
    tpBtn.MouseButton1Click:Connect(function()
        local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if hrp and SavedSlots[index] then
            hrp.CFrame = SavedSlots[index]
        end
    end)

    -- DELETE SLOT
    delBtn.MouseButton1Click:Connect(function()
        SavedSlots[index] = nil
        slot:Destroy()
    end)

    return slot
end

-- SAVE LOCATION
SaveBtn.MouseButton1Click:Connect(function()
    if #SavedSlots >= MaxSlots then
        SaveBtn.Text = "MAX (5/5)"
        task.wait(1)
        SaveBtn.Text = "+ Save Location"
        return
    end

    local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    table.insert(SavedSlots, hrp.CFrame)

    local newSlot = CreateSlot(#SavedSlots)
    newSlot.Position = UDim2.new(0, 0, 0, (#SavedSlots - 1) * 40)
end)

-- TOGGLE MINIMIZE
Minimize.MouseButton1Click:Connect(function()
    minimized = not minimized

    if minimized then
        MainFrame.Size = UDim2.new(0, 220, 0, 35)
        SaveBtn.Visible = false
        SlotHolder.Visible = false
        Minimize.Text = "+"
    else
        MainFrame.Size = UDim2.new(0, 220, 0, 280)
        SaveBtn.Visible = true
        SlotHolder.Visible = true
        Minimize.Text = "-"
    end
end)
